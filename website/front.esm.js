/* front.js - A secure-by-default micro-framework */
var i=null;function a(n){let r=n,o=new Set,e=(...t)=>{if(t.length===0)return i&&o.add(i),r;let s=t[0];return r!==s&&(r=s,o.forEach(c=>{try{c()}catch(d){console.error("[front.js] Error in value subscriber:",d)}})),r};return e.peek=()=>r,e}function u(n){if(typeof n!="function")return console.error("[front.js] run() requires a function argument."),()=>{};let r,o=()=>{if(r)try{r()}catch(t){console.error("[front.js] Error in run cleanup:",t)}let e=i;i=o;try{let t=n();r=typeof t=="function"?t:void 0}catch(t){console.error("[front.js] Error in run:",t)}finally{i=e}};return o(),()=>{if(r)try{r()}catch(e){console.error("[front.js] Error disposing run:",e)}r=void 0}}function m(n){if(typeof n!="function")return console.error("[front.js] calc() requires a function argument."),()=>{};let r;try{r=n()}catch(e){console.error("[front.js] Error calculating initial value:",e),r=void 0}let o=a(r);return u(()=>{try{let e=n();o(e)}catch(e){console.error("[front.js] Error recalculating value:",e)}}),()=>o()}import{render as y}from"uhtml";function f(n,r){if(typeof n!="function"){console.error("[front.js] defineComponent() requires a render function.");return}if(!r||!(r instanceof HTMLElement)){console.error("[front.js] defineComponent() requires a valid DOM element container.");return}let o=u(()=>{try{let e=n();y(r,e)}catch(e){console.error("[front.js] Error rendering component:",e,r),r.textContent="[front.js] Rendering error occurred."}});return r._front_dispose=o,o}var l=new Map;function p(n){return!n||typeof n!="string"?!1:/^[a-zA-Z0-9_-]+$/.test(n)}function j(n,r){if(!p(n)){console.error(`[front.js] Invalid component name "${n}". Component names must be alphanumeric (with optional underscores/hyphens).`);return}if(typeof r!="function"){console.error(`[front.js] Component "${n}" must be a function.`);return}l.set(n,r)}function h(n=document.body){n.querySelectorAll("[data-island]").forEach(o=>{let e=o.dataset.component;if(!e){console.warn('[front.js] Island element missing "data-component" attribute.',o);return}if(!p(e)){console.error(`[front.js] Invalid component name "${e}" on island element. Skipping.`,o);return}let t=l.get(e);if(!t){console.warn(`[front.js] Component "${e}" not registered. Skipping island.`,o);return}let s={};try{s=JSON.parse(o.dataset.props||"{}")}catch(c){console.error(`[front.js] Failed to parse props for component "${e}". Invalid JSON.`,c,o);return}try{let c=t(s);if(typeof c!="function"){console.error(`[front.js] Component "${e}" did not return a render function.`,o);return}f(c,o),o.removeAttribute("data-island")}catch(c){console.error(`[front.js] Error initializing component "${e}".`,c,o)}})}import{html as V,render as k}from"uhtml";export{m as calc,f as defineComponent,V as html,h as hydrate,j as register,k as render,u as run,a as val};
//# sourceMappingURL=front.esm.js.map
